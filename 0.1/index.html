<!doctype html>
<html lang="ja">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>パステルゾンビ（仮）</title>
<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0" />
<link rel="stylesheet" type="text/css" href="normalize.min.css" />
<link rel="stylesheet" type="text/css" href="fonts.min.css" />
<style type="text/css">
	body {
		font-family: "Meiryo", sans-serif;
		cursor: default;
	}
	input {
		font-family: "Meiryo UI", sans-serif;
	}

	input[type=text] {
		border: 1px solid;
		border-color: #777 #ddd #ddd #777;
	}
	input[type=button] {
		background-color: #eee;
		border: 1px solid;
		border-color: #ddd #777 #777 #ddd;
	}

	body {
		margin: 0;
		padding: 0;
		border: 0;
	}

	.menubar {
		border-top: #000 5px solid;
		background-color: #fff;
	}
	.menubar h1 {
		margin: 0;
		padding: 0 10px;
		color: #333;
		font-size: 12pt;
		line-height: 2.0;
	}
	.contents {
	}

	#menu {
		padding: 0 3px;
		border: #ddd 1px solid;
		border-radius: 1px;
		cursor: pointer;
	}
	#menu-layer {
		display: none;
	}

	#enchant-stage {
	}
</style>
<script type="text/javascript" src="jquery.min.js"></script>
<script type="text/javascript" src="enchant.min.js"></script>
<script type="text/javascript">

	$(function(){
		$("#menu").bind("click", function(){
			$("#menu-layer").slideToggle();
		});

		$("html").bind("pageshow", function(){
			$(this).find(".fixed").css({position:"fixed"});
		});
		$("html").bind("pagehide", function(){
			$(this).find(".fixed").css({position:"absolute"});
		});
	});

	$(function(){
		enchant();

		var assets = [
				"chara1.png",
				"map1.png"
			];

		var core = new Core(480, 480);

		var loadingScene = new Scene();
		loadingScene.addChild((function(){
			var label = new Label();
			label.x = 250;
			label.y = 250;
			label.text = "Loading...";
			return label;
		})());
		loadingScene.addEventListener("progress", function(e){
			var progress = e.loaded / e.total;
			progress *= 100;
			progress = Math.round(progress);
			this.removeChild(this.firstChild);
			this.addChild((function(){
				var label = new Label();
				label.x = 250;
				label.y = 250;
				label.text = "Loading... " + progress + "%";
				return label;
			})());
		});
		core.loadingScene = loadingScene;

		var portrait = new Scene();
		var landscape = new Scene();

		portrait.addChild((function(){
			var label = new Label("portrait");
			label.x = 10;
			label.y = 10;
			return label;
		})());

		landscape.addChild((function(){
			var label = new Label("landscape");
			label.x = 10;
			label.y = 10;
			return label;
		})());

		if ($(window).attr("orientation") == 0) {
			core.pushScene(portrait);
		}
		else {
			core.pushScene(landscape);
		}

		$(window).bind("orientationchange", function(){
			core.popScene();
			if ($(window).attr("orientation") == 0) {
				core.replaceScene(portrait);
			}
			else {
				core.replaceScene(landscape);
			}
		});

		core.fps = 15;
		core.preload(assets);
		core.scale = 1;
		core.addEventListener("load", function(){
	        var map = new Map(16, 16);
	        map.image = core.assets["map1.png"];
	        map.loadData(
	            [
					[  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0],
					[  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0],
					[  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0],
					[  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0],
					[  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0],
					[  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0],
					[  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0],
					[  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0],
					[100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100],
					[100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100],
					[100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100],
					[100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100],
					[100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100],
					[100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100],
					[100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100],
	            ]
	        );
	        core.rootScene.addChild(map);

			var bear = new Sprite(32, 32);
			bear.image = core.assets["chara1.png"];
			bear.x = 10;
			bear.y = 150;
			bear.frame = 5;
			core.rootScene.addChild(bear);
		});
		core.start();
	});
</script>
</head>
<body>
<div class="container">
	<div class="menubar">
		<h1>
			<span id="menu" class="icon-menu"></span>
			パステルゾンビ
			<span class="version">v0.1</span>
		</h1>
		<div id="menu-layer">
			15 fps
		</div>
	</div>
	<div class="contents">
		<div id="enchant-stage"></div>
	</div>
</div>
<body>
</html>
